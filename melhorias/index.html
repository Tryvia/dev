<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <link rel="icon" type="image/png" href="/tryvia.png" />
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calendário Gantt - Melhorias</title>
  <meta name="description" content="Visualização Gantt de work items do Azure DevOps - Projeto Melhorias" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

  <!-- Header -->
  <header class="header">
    <div class="header-left">
      <div class="header-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" x2="18" y1="20" y2="10"/><line x1="12" x2="12" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="14"/></svg>
      </div>
      <div>
        <h1>Melhorias</h1>
        <p>Projeto de Melhorias</p>
      </div>
    </div>
    <div class="header-right" id="headerCount">0 work items carregados</div>
  </header>

  <main class="main">
    <!-- Error banner -->
    <div class="error-banner" id="errorBanner">
      <div class="error-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></svg>
      </div>
      <div>
        <p class="error-title">Erro ao sincronizar</p>
        <p class="error-msg" id="errorMsg"></p>
      </div>
    </div>

    <!-- Stats -->
    <div class="stats-grid" id="statsGrid"></div>

    <!-- Filters -->
    <div class="filters-card">
      <div class="filters-header">
        <h2>Filtros</h2>
        <div class="filters-header-right">
          <span class="last-sync" id="lastSyncLabel"></span>
          <button class="btn-sync" id="btnSync" onclick="syncWorkItems()">
            <svg id="syncIcon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 16h5v5"/></svg>
            <span id="syncText">Sincronizar</span>
          </button>
        </div>
      </div>

      <!-- Month nav -->
      <div class="month-nav">
        <button class="btn-month" onclick="navigateMonth(-1)">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
        </button>
        <span class="month-label" id="monthLabel"></span>
        <button class="btn-month" onclick="navigateMonth(1)">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg>
        </button>
      </div>

      <div class="filters-grid">
        <div class="filter-group">
          <label>Buscar</label>
          <div class="search-wrapper">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
            <input type="text" id="filterSearch" placeholder="Pesquisar work item..." oninput="applyFilters()" />
          </div>
        </div>
        <div class="filter-group">
          <label>Responsável</label>
          <select id="filterAssignee" onchange="applyFilters()"><option value="all">Todos</option></select>
        </div>
        <div class="filter-group">
          <label>Coluna</label>
          <select id="filterBoardColumn" onchange="applyFilters()"><option value="all">Todas as Colunas</option></select>
        </div>
        <div class="filter-group">
          <label>Sistema</label>
          <select id="filterSistema" onchange="applyFilters()"><option value="all">Todos os Sistemas</option></select>
        </div>
        <div class="filter-group">
          <label>Período</label>
          <select id="filterDateRange" onchange="applyFilters()">
            <option value="all">Todos do mês</option>
            <option value="starts">Inicia neste mês</option>
            <option value="ends">Finaliza neste mês</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Loading -->
    <div class="loading-container" id="loadingContainer">
      <div class="spinner"></div>
      <p>Sincronizando com Azure DevOps...</p>
    </div>

    <!-- Gantt -->
    <div class="gantt-container" id="ganttContainer" style="display:none;"></div>

    <!-- Empty -->
    <div class="empty-msg" id="emptyMsg" style="display:none;">Nenhum work item encontrado para este mês.</div>
  </main>

  <!-- Tooltip -->
  <div class="gantt-tooltip" id="tooltip"></div>

  <script src="app.js"></script>
</body>
</html>
